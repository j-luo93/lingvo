

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lingvo.core.base_layer module &mdash; lingvo  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="lingvo.core.base_model module" href="lingvo.core.base_model.html" />
    <link rel="prev" title="lingvo.core.base_input_generator module" href="lingvo.core.base_input_generator.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> lingvo
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="lingvo.html">lingvo package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="lingvo.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="lingvo.core.html">lingvo.core package</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="lingvo.core.html#subpackages">Subpackages</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="lingvo.core.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lingvo.tasks.html">lingvo.tasks package</a></li>
<li class="toctree-l3"><a class="reference internal" href="lingvo.tools.html">lingvo.tools package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lingvo.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">lingvo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="lingvo.html">lingvo package</a> &raquo;</li>
        
          <li><a href="lingvo.core.html">lingvo.core package</a> &raquo;</li>
        
      <li>lingvo.core.base_layer module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/lingvo.core.base_layer.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-lingvo.core.base_layer">
<span id="lingvo-core-base-layer-module"></span><h1>lingvo.core.base_layer module<a class="headerlink" href="#module-lingvo.core.base_layer" title="Permalink to this headline">¶</a></h1>
<p>Base class for all layers.</p>
<dl class="class">
<dt id="lingvo.core.base_layer._LocalLayerStack">
<em class="property">class </em><code class="descclassname">lingvo.core.base_layer.</code><code class="descname">_LocalLayerStack</code><a class="reference internal" href="_modules/lingvo/core/base_layer.html#_LocalLayerStack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer._LocalLayerStack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">thread._local</span></code></p>
</dd></dl>

<dl class="class">
<dt id="lingvo.core.base_layer.Accumulator">
<em class="property">class </em><code class="descclassname">lingvo.core.base_layer.</code><code class="descname">Accumulator</code><a class="reference internal" href="_modules/lingvo/core/base_layer.html#Accumulator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.Accumulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Layers can register accumulators to persist step-level state.</p>
<p>Accumulators must be represented by a Tensor of a fixed shape. The default
value must be supplied by overriding DefaultValue(). It is important that
the default tensor value is created on each call in order to avoid
accumulators leaking to different graphs.</p>
<p>Accumulators can be enabled (default) or disabled by pairing
Disable()/Enable() calls. When disabled, the accumulator will only return
the default value and will silently drop calls to SetValue(). When computing
gradients that may touch accumulators, calls should be bracketed with
Disable()/Enable().</p>
<p>Care must be taken when manipulating accumulators across Defun boundaries.
Typically, values for all accumulators in a layer must be explicitly
retrieved and passed in to the Defun scope by calling
layer.GetAccumulatorValues(), marshalling into the Defun and setting them
via layer.SetAccumulatorValues(). The reverse must be done on return.</p>
<dl class="attribute">
<dt id="lingvo.core.base_layer.Accumulator.is_disabled">
<code class="descname">is_disabled</code><a class="headerlink" href="#lingvo.core.base_layer.Accumulator.is_disabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the accumulator is disabled.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.Accumulator.Disable">
<code class="descname">Disable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#Accumulator.Disable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.Accumulator.Disable" title="Permalink to this definition">¶</a></dt>
<dd><p>Disables the accumulator (must be balanced with Enable).</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.Accumulator.Enable">
<code class="descname">Enable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#Accumulator.Enable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.Accumulator.Enable" title="Permalink to this definition">¶</a></dt>
<dd><p>Enables the accumulator (must balance a Disable).</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.Accumulator.GetValue">
<code class="descname">GetValue</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#Accumulator.GetValue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.Accumulator.GetValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the current value of the accumulator Tensor.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.Accumulator.SetValue">
<code class="descname">SetValue</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#Accumulator.SetValue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.Accumulator.SetValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the current value of the accumulator Tensor.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.Accumulator.Reset">
<code class="descname">Reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#Accumulator.Reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.Accumulator.Reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the accumulator to its default value.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.Accumulator.DefaultValue">
<code class="descname">DefaultValue</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#Accumulator.DefaultValue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.Accumulator.DefaultValue" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="lingvo.core.base_layer.initializer">
<code class="descclassname">lingvo.core.base_layer.</code><code class="descname">initializer</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#initializer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator for layer’s __init__.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>func</strong> – The __init__ method of <a class="reference internal" href="#lingvo.core.base_layer.LayerBase" title="lingvo.core.base_layer.LayerBase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LayerBase</span></code></a>’s subclasses.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A decorator wrapper for layer’s initializer.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.base_layer.DefaultVN">
<code class="descclassname">lingvo.core.base_layer.</code><code class="descname">DefaultVN</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#DefaultVN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.DefaultVN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.base_layer.RecursiveFindLayerParams">
<code class="descclassname">lingvo.core.base_layer.</code><code class="descname">RecursiveFindLayerParams</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#RecursiveFindLayerParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.RecursiveFindLayerParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all params that define a layer.</p>
</dd></dl>

<dl class="class">
<dt id="lingvo.core.base_layer.LayerBase">
<em class="property">class </em><code class="descclassname">lingvo.core.base_layer.</code><code class="descname">LayerBase</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for all the layer object.</p>
<dl class="attribute">
<dt id="lingvo.core.base_layer.LayerBase._INFERENCE_DRIVER_NAME">
<code class="descname">_INFERENCE_DRIVER_NAME</code><em class="property"> = None</em><a class="headerlink" href="#lingvo.core.base_layer.LayerBase._INFERENCE_DRIVER_NAME" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="lingvo.core.base_layer.LayerBase.Params">
<em class="property">classmethod </em><code class="descname">Params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.Params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.Params" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the layer params.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.base_layer.LayerBase.CopyBaseParams">
<em class="property">static </em><code class="descname">CopyBaseParams</code><span class="sig-paren">(</span><em>from_params</em>, <em>to_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.CopyBaseParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.CopyBaseParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies LayerBase params from <code class="xref py py-obj docutils literal notranslate"><span class="pre">from_params</span></code> to <code class="xref py py-obj docutils literal notranslate"><span class="pre">to_params</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.FPropDefaultTheta">
<code class="descname">FPropDefaultTheta</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.FPropDefaultTheta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.FPropDefaultTheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls <a class="reference internal" href="#lingvo.core.base_layer.LayerBase.FProp" title="lingvo.core.base_layer.LayerBase.FProp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FProp</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.FProp">
<code class="descname">FProp</code><span class="sig-paren">(</span><em>theta</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.FProp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.FProp" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward propagation.</p>
<p>The central interface that subclasses should implement. The caller
calls <a class="reference internal" href="#lingvo.core.base_layer.LayerBase.FProp" title="lingvo.core.base_layer.LayerBase.FProp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FProp</span></code></a> with a <a class="reference internal" href="#lingvo.core.base_layer.LayerBase.theta" title="lingvo.core.base_layer.LayerBase.theta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">theta</span></code></a> dictionary. E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">foo</span> <span class="o">=</span> <span class="n">InstanceOfASubClassOfFoo</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">foo</span><span class="o">.</span><span class="n">FProp</span><span class="p">(</span><span class="n">foo</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>The implementation of <a class="reference internal" href="#lingvo.core.base_layer.LayerBase.FProp" title="lingvo.core.base_layer.LayerBase.FProp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FProp()</span></code></a> computes a function given
the theta and the inputs. E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">subs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">a0</span> <span class="o">=</span> <span class="n">subs</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">FProp</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">linear</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span>
<span class="n">a1</span> <span class="o">=</span> <span class="n">subs</span><span class="o">.</span><span class="n">softmax</span><span class="o">.</span><span class="n">FProp</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">softmax</span><span class="p">,</span> <span class="n">a0</span><span class="p">)</span>
<span class="c1"># The same layer applied twice.</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">subs</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">FProp</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">linear</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
<span class="k">return</span> <span class="n">a2</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>theta</strong> – A <a class="reference internal" href="lingvo.core.py_utils.html#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> object containing weights’ values of this
layer and its children layers.</li>
<li><strong>*args</strong> – List args.</li>
<li><strong>**kwargs</strong> – Keyward args.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="lingvo.core.base_layer.LayerBase.FPropMeta">
<em class="property">classmethod </em><code class="descname">FPropMeta</code><span class="sig-paren">(</span><em>params</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.FPropMeta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.FPropMeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns metadata about the <a class="reference internal" href="#lingvo.core.base_layer.LayerBase.FProp" title="lingvo.core.base_layer.LayerBase.FProp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FProp</span></code></a> computation for this layer.</p>
<p><strong>Experimental feature.</strong>
Don’t use or depend on it without consulting Lingvo authors.</p>
<p>E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">SomeComplexLayer</span><span class="o">.</span><span class="n">Params</span><span class="p">()</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">cls</span><span class="o">.</span><span class="n">FPropMeta</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">([</span><span class="mi">128</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">32</span><span class="p">]))</span>
</pre></div>
</div>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">meta.flops</span></code> gives an estimate count of floating point operations done by
one <a class="reference internal" href="#lingvo.core.base_layer.LayerBase.FProp" title="lingvo.core.base_layer.LayerBase.FProp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FProp</span></code></a> given an input tensor of shape [128, 20, 50, 32].
<code class="xref py py-obj docutils literal notranslate"><span class="pre">meta.out_shapes</span></code> is a tuple of tensor shapes, which tells you what shape
of tensors this layer will return.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> – The param of a layer of this layer type.</li>
<li><strong>*args</strong> – Corresponds to FProp with Tensors replaced by <code class="xref py py-obj docutils literal notranslate"><span class="pre">TensorShape</span></code>.</li>
<li><strong>**kwargs</strong> – Corresponds to FProp with Tensors replaced by <code class="xref py py-obj docutils literal notranslate"><span class="pre">TensorShape</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>A <a class="reference internal" href="lingvo.core.py_utils.html#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> with</p>
<ul class="simple">
<li>flops - The estimated number of floating point operations incurred by
this fprop.</li>
<li>out_shapes - A tuple of <code class="xref py py-obj docutils literal notranslate"><span class="pre">tf.TensorShape</span></code>. I.e., <code class="xref py py-obj docutils literal notranslate"><span class="pre">out_shapes[i]</span></code>
represents the shape of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">i</span></code>-th returned tensor of the fprop.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="lingvo.core.base_layer.LayerBase.params">
<code class="descname">params</code><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.params" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the params upon which this layer is built.</p>
</dd></dl>

<dl class="attribute">
<dt id="lingvo.core.base_layer.LayerBase.children">
<code class="descname">children</code><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.children" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns children layers of this layer in a <a class="reference internal" href="lingvo.core.py_utils.html#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="lingvo.core.base_layer.LayerBase.vars">
<code class="descname">vars</code><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.vars" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns variables of this layer and its children in a <a class="reference internal" href="lingvo.core.py_utils.html#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="lingvo.core.base_layer.LayerBase.theta">
<code class="descname">theta</code><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns theta of this layer and its children in a <a class="reference internal" href="lingvo.core.py_utils.html#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="lingvo.core.base_layer.LayerBase.accumulators">
<code class="descname">accumulators</code><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.accumulators" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <a class="reference internal" href="lingvo.core.py_utils.html#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of <a class="reference internal" href="#lingvo.core.base_layer.Accumulator" title="lingvo.core.base_layer.Accumulator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Accumulator</span></code></a> instances for this and children.</p>
</dd></dl>

<dl class="attribute">
<dt id="lingvo.core.base_layer.LayerBase.fns">
<code class="descname">fns</code><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.fns" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a read-only view of layer local functions.</p>
<p>Functions can be accessed by index ([‘name’]) or attribute notation
(<code class="xref py py-obj docutils literal notranslate"><span class="pre">fns.foo</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Read-only attribute accessible dict view of the layer’s function library.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.AddFunction">
<code class="descname">AddFunction</code><span class="sig-paren">(</span><em>name</em>, <em>f</em>, <em>replace=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.AddFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.AddFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a function to the layer’s <a class="reference internal" href="#lingvo.core.base_layer.LayerBase.fns" title="lingvo.core.base_layer.LayerBase.fns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fns</span></code></a> collection.</p>
<p>This should be used to add op-like functions specific to the operation
of the layer and its children. Such functions should be added in <code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code>
and may either be raw python functions or TensorFlow Defuns. This
facility is just a mechanism for organizing them and having basic checks
on name collisions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> – The function name. It will be accessible as <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.fns.{name}</span></code>.</li>
<li><strong>f</strong> – The function body.</li>
<li><strong>replace</strong> – Whether to replace an existing function (default False).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">AttributeError</span></code> – If the function already exists and replace == False.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase._CheckName">
<code class="descname">_CheckName</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase._CheckName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase._CheckName" title="Permalink to this definition">¶</a></dt>
<dd><p>Asserts name’s validity.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase._VariableCollections">
<code class="descname">_VariableCollections</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase._VariableCollections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase._VariableCollections" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.RegisterAccumulator">
<code class="descname">RegisterAccumulator</code><span class="sig-paren">(</span><em>name</em>, <em>acc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.RegisterAccumulator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.RegisterAccumulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers an accumulator for this layer.</p>
<p>An accumulator is used to propagate some state to a future point,
where it is acted on (typically as part of <a class="reference internal" href="#lingvo.core.base_layer.LayerBase.PostTrainingStepUpdate" title="lingvo.core.base_layer.LayerBase.PostTrainingStepUpdate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PostTrainingStepUpdate</span></code></a>). This
mechanism allows for arbitrarily nested parts of a model to export state
back to the global scope. Accumulators must be specially handled
when crossing into <code class="xref py py-obj docutils literal notranslate"><span class="pre">Defun</span></code> or recurrent scopes. By abstracting the
mechanism, it allows all such state to be handled uniformly and generically.</p>
<p>Example (typically from <code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyAccumulator</span><span class="p">(</span><span class="n">base_layer</span><span class="o">.</span><span class="n">Accumulator</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">DefaultValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># [count, min, max]</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
  <span class="k">def</span> <span class="nf">Update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state1</span><span class="p">):</span>
    <span class="n">state0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span>
        <span class="n">state0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">state1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">state0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">state1</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">state0</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">state1</span><span class="p">[</span><span class="mi">2</span><span class="p">])]))</span>

<span class="bp">self</span><span class="o">.</span><span class="n">RegisterAccumulator</span><span class="p">(</span><span class="s1">&#39;mytracker&#39;</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span>
</pre></div>
</div>
<p>Later, access the current value and update it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">acc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accumulators</span><span class="o">.</span><span class="n">mytracker</span>
<span class="n">acc</span><span class="o">.</span><span class="n">Update</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">batch_min</span><span class="p">,</span> <span class="n">batch_max</span><span class="p">]))</span>
</pre></div>
</div>
<p>Then, typically in <a class="reference internal" href="#lingvo.core.base_layer.LayerBase.PostTrainingStepUpdate" title="lingvo.core.base_layer.LayerBase.PostTrainingStepUpdate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PostTrainingStepUpdate</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">acc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accumulator</span><span class="o">.</span><span class="n">mytracker</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
<span class="n">acc_value</span> <span class="o">=</span> <span class="n">acc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
<span class="c1"># Do something with the value.</span>
<span class="n">acc</span><span class="o">.</span><span class="n">Reset</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – The accumulator name. Shares a namespace with children, vars and
extra theta.</li>
<li><strong>acc</strong> – An <a class="reference internal" href="#lingvo.core.base_layer.Accumulator" title="lingvo.core.base_layer.Accumulator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Accumulator</span></code></a> instance.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.GetAccumulatorValues">
<code class="descname">GetAccumulatorValues</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.GetAccumulatorValues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.GetAccumulatorValues" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively gets values of all accumulators.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="lingvo.core.py_utils.html#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of Tensors for each registered accumulator.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.SetAccumulatorValues">
<code class="descname">SetAccumulatorValues</code><span class="sig-paren">(</span><em>new_values_nmap</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.SetAccumulatorValues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.SetAccumulatorValues" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively sets the values of all accumulators from a map.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>new_values_nmap</strong> – <a class="reference internal" href="lingvo.core.py_utils.html#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of accumulator name:Tensor.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.CreateVariable">
<code class="descname">CreateVariable</code><span class="sig-paren">(</span><em>name</em>, <em>var_params</em>, <em>theta_fn=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.CreateVariable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.CreateVariable" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a variable of this layer according to the parameter <code class="xref py py-obj docutils literal notranslate"><span class="pre">var_params</span></code>.</p>
<p>E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>    <span class="c1"># A layer&#39;s constructor</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">CreateVariable</span><span class="p">(</span>
      <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="n">py_utils</span><span class="o">.</span><span class="n">WeightParams</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]))</span>
</pre></div>
</div>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">theta_fn</span></code> is used to apply a simple transformation on the created
variable’s value before used by the forward computation. E.g., to
add the global variational noise according to this layer’s
parameter, one can do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>    <span class="c1"># A layer&#39;s constructor</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">CreateVariable</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span>
    <span class="n">var_params</span><span class="o">=</span><span class="n">py_utils</span><span class="o">.</span><span class="n">WeightParams</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]),</span>
    <span class="n">theta_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">AddGlobalVN</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – Variable name which is used as the key into vars/theta.</li>
<li><strong>var_params</strong> – <a class="reference internal" href="#lingvo.core.base_layer.LayerBase.Params" title="lingvo.core.base_layer.LayerBase.Params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Params</span></code></a> used to create the variable.</li>
<li><strong>theta_fn</strong> – A python function that takes a variable’s value and returns a
new value to be used later for computation. Its signature must be
(tf.Tensor) -&gt; (tf.Tensor).</li>
<li><strong>*args</strong> – List of args passed to <a class="reference internal" href="lingvo.core.py_utils.html#lingvo.core.py_utils.CreateVariable" title="lingvo.core.py_utils.CreateVariable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">py_utils.CreateVariable</span></code></a>.</li>
<li><strong>**kwargs</strong> – Keyword args passed to <a class="reference internal" href="lingvo.core.py_utils.html#lingvo.core.py_utils.CreateVariable" title="lingvo.core.py_utils.CreateVariable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">py_utils.CreateVariable</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.AddExtraTheta">
<code class="descname">AddExtraTheta</code><span class="sig-paren">(</span><em>theta_name</em>, <em>theta_value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.AddExtraTheta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.AddExtraTheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Add extra <a class="reference internal" href="#lingvo.core.base_layer.LayerBase.theta" title="lingvo.core.base_layer.LayerBase.theta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">theta</span></code></a> that doesn’t directly correspond to <a class="reference internal" href="#lingvo.core.base_layer.LayerBase.vars" title="lingvo.core.base_layer.LayerBase.vars"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vars</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.AddGlobalVN">
<code class="descname">AddGlobalVN</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.AddGlobalVN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.AddGlobalVN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.CreateChild">
<code class="descname">CreateChild</code><span class="sig-paren">(</span><em>name</em>, <em>params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.CreateChild"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.CreateChild" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a sub layer.</p>
<p>The created sub layer can be accessed by <code class="xref py py-obj docutils literal notranslate"><span class="pre">name</span></code>. E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">CreateChild</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">FProp</span><span class="o">...</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Fprop</span><span class="o">...</span>
<span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">Fprop</span><span class="o">...</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – Sub layer name which is used as the key into vars/theta.</li>
<li><strong>params</strong> – <code class="xref py py-obj docutils literal notranslate"><span class="pre">Hyperparams</span></code> object to instantiate a layer.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.CreateChildren">
<code class="descname">CreateChildren</code><span class="sig-paren">(</span><em>name</em>, <em>params_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.CreateChildren"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.CreateChildren" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a list of sub layers.</p>
<p>The created sub layer list can be accessed by <code class="xref py py-obj docutils literal notranslate"><span class="pre">name</span></code>. E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">CreateChildren</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">foo</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">FProp</span><span class="o">...</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">Fprop</span><span class="o">...</span>
<span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="o">.</span><span class="n">foo</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">Fprop</span><span class="o">...</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> – The name for the sub layers, which is used as the key
into vars/theta.</li>
<li><strong>params_list</strong> – <code class="xref py py-obj docutils literal notranslate"><span class="pre">Hyperparams</span></code> objects to instantiate a list of layers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.AddChild">
<code class="descname">AddChild</code><span class="sig-paren">(</span><em>name</em>, <em>child</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.AddChild"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.AddChild" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an existing layer as a sublayer.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.AddChildren">
<code class="descname">AddChildren</code><span class="sig-paren">(</span><em>name</em>, <em>children</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.AddChildren"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.AddChildren" title="Permalink to this definition">¶</a></dt>
<dd><p>Add existing layers as sublayers.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase._AutoAddChild">
<code class="descname">_AutoAddChild</code><span class="sig-paren">(</span><em>child</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase._AutoAddChild"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase._AutoAddChild" title="Permalink to this definition">¶</a></dt>
<dd><p>Record that a layer <code class="xref py py-obj docutils literal notranslate"><span class="pre">child</span></code> is instantiated by this layer.</p>
<p>This is a method only called by <code class="xref py py-obj docutils literal notranslate"><span class="pre">base_layer.initializer</span></code> decorator.
Subclasses should not call this method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>child</strong> – A sub-layer of this layer.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase._CheckInvariants">
<code class="descname">_CheckInvariants</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase._CheckInvariants"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase._CheckInvariants" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase._VerifyChildren">
<code class="descname">_VerifyChildren</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase._VerifyChildren"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase._VerifyChildren" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify all children created by this layer are via <code class="xref py py-obj docutils literal notranslate"><span class="pre">CreateChild(ren)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase._VerifyVarsAndTheta">
<code class="descname">_VerifyVarsAndTheta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase._VerifyVarsAndTheta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase._VerifyVarsAndTheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify that vars and theta have the same nested structure.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.base_layer.LayerBase.PostTrainingStepUpdate">
<code class="descname">PostTrainingStepUpdate</code><span class="sig-paren">(</span><em>global_step</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/base_layer.html#LayerBase.PostTrainingStepUpdate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.base_layer.LayerBase.PostTrainingStepUpdate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a TF op which will be invoked at each training step.</p>
<p>Subclasses of <a class="reference internal" href="#lingvo.core.base_layer.LayerBase" title="lingvo.core.base_layer.LayerBase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LayerBase</span></code></a> can implement this method. The method should
return a TF op to be invoked during training after gradients are applied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>global_step</strong> – the global step.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lingvo.core.base_model.html" class="btn btn-neutral float-right" title="lingvo.core.base_model module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lingvo.core.base_input_generator.html" class="btn btn-neutral" title="lingvo.core.base_input_generator module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>